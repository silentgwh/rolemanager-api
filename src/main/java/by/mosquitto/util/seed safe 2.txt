-- 1. Создание профиля SYSADMIN
INSERT INTO profile (name, comment, user_corr)
VALUES ('SYSADMIN_PROFILE', 'Профиль системного администратора', NULL);

-- 2. Создание роли SYSADMIN
INSERT INTO role (name, type, comment, user_corr)
VALUES ('SYSADMIN', 1, 'Системный администратор', NULL);

-- 3. Связь профиля и роли SYSADMIN
INSERT INTO profile_role (id_prof, id_role)
VALUES (
    (SELECT id FROM profile WHERE name = 'SYSADMIN_PROFILE'),
    (SELECT id FROM role WHERE name = 'SYSADMIN')
);

-- 4. Создание пользователя sysadmin с BCrypt-хешем пароля "admin123"
INSERT INTO users (username, password, profile_id, role_id)
VALUES (
    'sysadmin',
    '$2a$10$Kx9ZJvQeW9ZQwYxvKxU9e.TzFZ3eKZzU9eTzFZ3eKZzU9eTzFZ3e',
    (SELECT id FROM profile WHERE name = 'SYSADMIN_PROFILE'),
    (SELECT id FROM role WHERE name = 'SYSADMIN')
);

-- 5. Привилегии, привязанные к пользователю sysadmin
INSERT INTO privilege (name, type, name_2, comment, user_corr, is_private)
VALUES
('MANAGE_USERS', 1, 'Управление пользователями', 'Создание и удаление пользователей',
    (SELECT id FROM users WHERE username = 'sysadmin'), false),
('VIEW_REPORTS', 0, 'Просмотр отчётов', 'Доступ к аналитике',
    (SELECT id FROM users WHERE username = 'sysadmin'), false);

-- 6. Создание роли ADMIN, привязанной к sysadmin
INSERT INTO role (name, type, comment, user_corr)
VALUES ('ADMIN', 0, 'Администратор системы',
    (SELECT id FROM users WHERE username = 'sysadmin'));

-- 7. Связь роли ADMIN с привилегиями
INSERT INTO role_privilege (id_role, id_priv)
VALUES
((SELECT id FROM role WHERE name = 'ADMIN'), (SELECT id FROM privilege WHERE name = 'MANAGE_USERS')),
((SELECT id FROM role WHERE name = 'ADMIN'), (SELECT id FROM privilege WHERE name = 'VIEW_REPORTS'));

-- 8. Создание профиля ADMIN, привязанного к sysadmin
INSERT INTO profile (name, comment, user_corr)
VALUES ('ADMIN_PROFILE', 'Профиль администратора',
    (SELECT id FROM users WHERE username = 'sysadmin'));

-- 9. Связь профиля ADMIN с ролью ADMIN
INSERT INTO profile_role (id_prof, id_role)
VALUES (
    (SELECT id FROM profile WHERE name = 'ADMIN_PROFILE'),
    (SELECT id FROM role WHERE name = 'ADMIN')
);
